# Generated by Selenium IDE
import os
import pytest
import time
import json
import configparser
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.support import expected_conditions
from selenium.webdriver.support.wait import WebDriverWait
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from selenium.webdriver.chrome.service import Service

class WebProTagSet():
  def setupMethod(self):
    # get parent directory
    runTest.workDir = os.getcwd()
    # read config.ini
    path = self.workDir + "\Config"
    self.config = configparser.ConfigParser()
    self.config.read(os.path.join(path, 'config.ini'))

  def tearUpMethod(self):
    service = Service(self.workDir + '\Bin\chromedriver.exe')
    self.driver = webdriver.Chrome(service = service)
    self.driver.maximize_window()
    self.vars = {}
  
  def tearDownMethod(self):
    self.driver.quit()
  
  def webProTagSet(self):
    webpro_username = self.config['WEBPRO']['username']
    webpro_password = self.config['WEBPRO']['password']
    webpro_url = self.config['WEBPRO']['webProUrl']
    
    self.driver.get(webpro_url)
    self.driver.find_element(By.ID, "maintainer").click()
    self.driver.find_element(By.ID, "maintainer").send_keys(webpro_username)
    self.driver.find_element(By.ID, "pw").click()
    self.driver.find_element(By.ID, "pw").send_keys(webpro_password)
    self.driver.find_element(By.NAME, "bv:act_OK").click()

    element = self.driver.find_element(By.ID, "menu_item_account")
    actions = ActionChains(self.driver)
    actions.move_to_element(element).perform()
    self.driver.find_element(By.CSS_SELECTOR, "#menu_item_account > span").click()
    self.driver.find_element(By.LINK_TEXT, "Tag sets").click()

    # audience
    self.driver.find_element(By.CSS_SELECTOR, "tr:nth-child(1) > td span").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("private")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Private")
    self.driver.find_element(By.ID, "term_admin_name-value_label").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Private")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("public")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Public")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Public")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_back").click()

    # taxonomy-1
    self.driver.find_element(By.CSS_SELECTOR, "tr:nth-child(2) > td span").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_creditbuilder")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Credit Cards > Credit Builder")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Credit Cards > Credit Builder")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_goldrewards")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Credit Cards > Gold Rewards")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Credit Cards > Gold Rewards")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_platinumcashback")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Credit Cards > Platinum Cashback")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Credit Cards > Platinum Cashback")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_fixedrate2year")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Mortgages > Fixed Rate 2 Year")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Mortgages > Fixed Rate 2 Year")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_fixedrate5year")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Mortgages > Fixed Rate 5 Year")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Mortgages > Fixed Rate 5 Year")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_personalloans98k")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Personal Loans")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Personal Loans")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_retailbanking")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Retail Banking")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Retail Banking")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("product_isa")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Saving Accounts > ISA")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Saving Accounts > ISA")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_back").click()

    # taxonomy-2
    self.driver.find_element(By.CSS_SELECTOR, "tr:nth-child(3) > td span").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_africa")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Africa")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Africa")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_canada")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Canada")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Canada")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_france")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("France")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("France")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_mexico")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Mexico")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Mexico")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_thenetherlands")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Netherlands")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Netherlands")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_northamerica")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("North America")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("North America")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_northamericapkg")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("North America Pkg")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("North America Pkg")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_spain")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Spain")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Spain")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("region_unitedkingdom")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("United Kingdom")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("United Kingdom")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_back").click()

    # taxonomy-3
    self.driver.find_element(By.CSS_SELECTOR, "tr:nth-child(4) > td span").click()
    self.driver.find_element(By.NAME, "bv:act_assign").click()
    self.driver.find_element(By.CSS_SELECTOR, "tr:nth-child(5) .input-checkbox").click()
    self.driver.find_element(By.CSS_SELECTOR, ".footer > .btn").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("complaints")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Complaints")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Complaints")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("fraud")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Fraud")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Fraud")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("general-inquiry")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("General Inquiry")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("General Inquiry")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_add").click()
    self.driver.find_element(By.ID, "term_id-value").click()
    self.driver.find_element(By.ID, "term_id-value").send_keys("mortgage")
    self.driver.find_element(By.ID, "term_friendly_name-value").click()
    self.driver.find_element(By.ID, "term_friendly_name-value").send_keys("Mortgages")
    self.driver.find_element(By.ID, "term_admin_name-value").click()
    self.driver.find_element(By.ID, "term_admin_name-value").send_keys("Mortgages")
    self.driver.find_element(By.NAME, "bv:act_create_term").click()
    self.driver.find_element(By.NAME, "bv:act_back").click()
  
if __name__ == '__main__':
  print("Hi python")
  runTest = WebProTagSet()
  runTest.setupMethod()
  runTest.tearUpMethod()
  runTest.webProTagSet()
  runTest.tearDownMethod()